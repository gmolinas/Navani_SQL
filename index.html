<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navani SQL</title>
    <link rel="icon" type="image/png" href="Navani SQLIcon.png">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- CSS Modules -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/editor.css">
    <link rel="stylesheet" href="css/canvas.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="logo-icon">
                <img src="Navani SQLIcon.png" alt="Navani SQL" width="18" height="18">
            </div>
            <span class="logo-text">Navani SQL</span>
            <span class="header-separator"></span>
            <input type="text" class="schema-name-input" id="schemaNameInput" value="Untitled Schema" spellcheck="false">
        </header>

        <div class="toolbar">
            <button class="btn btn-primary" id="runBtn"><i class="fas fa-play"></i> Run</button>
            <button class="btn btn-secondary" id="clearBtn"><i class="fas fa-trash"></i> Clear</button>
            <div style="width:1px;height:20px;background:var(--border-primary);margin:0 8px"></div>
            <button class="btn btn-secondary" id="exportPngBtn"><i class="fas fa-image"></i> PNG</button>
            <button class="btn btn-secondary" id="exportJsonBtn"><i class="fas fa-download"></i> Download</button>
            <button class="btn btn-secondary" id="copySqlBtn"><i class="fas fa-copy"></i> Copy</button>
            <div style="width:1px;height:20px;background:var(--border-primary);margin:0 8px"></div>
            <button class="btn btn-secondary" id="shareBtn"><i class="fas fa-share-alt"></i> Share</button>
            <div class="spacer"></div>
            <button class="zoom-btn" id="zoomOutBtn">-</button>
            <span class="zoom-display" id="zoomDisplay">100%</span>
            <button class="zoom-btn" id="zoomInBtn">+</button>
            <button class="zoom-btn" id="fitBtn"><i class="fas fa-expand"></i></button>
            <div style="width:1px;height:20px;background:var(--border-primary);margin:0 8px"></div>
            <button class="zoom-btn theme-toggle" id="themeToggleBtn" title="Toggle theme"><i class="fas fa-moon"></i></button>
        </div>

        <main class="main">
            <div class="editor-panel" id="editorPanel">
                <div class="panel-header">
                    <i class="fas fa-code" style="margin-right:8px;color:var(--text-secondary)"></i>dbdiagram DSL
                    <span class="panel-header-spacer"></span>
                    <button class="style-toggle-btn active" id="styleToggleBtn" title="Show/hide style attributes (icon, color)">
                        <i class="fas fa-palette"></i>
                    </button>
                </div>
                <div class="editor-content">
                    <div class="line-numbers" id="lineNumbers">1</div>
                    <div class="editor-input-wrapper">
                        <pre class="syntax-highlight" id="syntaxHighlight" aria-hidden="true"></pre>
                        <textarea class="sql-input" id="sqlInput" spellcheck="false" placeholder="// Write your dbdiagram DSL here
Table users {
  id int [pk, increment]
  username varchar(50) [not null]
  email varchar(100) [unique]
}

Table posts {
  id int [pk, increment]
  user_id int [ref: > users.id]
  title varchar(200)
  content text
}"></textarea>
                    </div>
                </div>
            </div>

            <div class="resizer" id="resizer"></div>

            <div class="diagram-panel">
                <div class="diagram-toolbar">
                    <button class="btn btn-secondary" id="addTableBtn"><i class="fas fa-plus"></i> Add Table</button>
                </div>

                <div class="schemas-panel" id="schemasPanel">
                    <div class="schemas-panel-header">
                        <button class="schemas-panel-toggle" id="schemasPanelToggle" title="Toggle panel"><i class="fas fa-chevron-down"></i></button>
                        <span class="schemas-panel-title">Schemas</span>
                        <button class="schemas-panel-btn" id="saveSchemaBtn" title="Save current schema"><i class="fas fa-save"></i></button>
                    </div>
                    <div class="schemas-list" id="schemasList"></div>
                </div>

                <div class="canvas-area" id="canvasArea">
                    <div class="canvas" id="canvas">
                        <svg class="lines-svg" id="linesSvg"></svg>
                    </div>
                    <div class="empty-state" id="emptyState">
                        <div class="empty-icon"><i class="fas fa-database"></i></div>
                        <div class="empty-title">No tables yet</div>
                        <div class="empty-text">Write dbdiagram DSL or drag a template</div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div class="modal-overlay hidden" id="tableModal">
        <div class="modal">
            <h2 class="modal-title"><i class="fas fa-table"></i> <span id="modalTitle">Add Table</span></h2>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Icon</label>
                    <div class="icon-picker-grid" id="iconPickerGrid"></div>
                </div>
                <div class="form-group">
                    <label class="form-label">Color</label>
                    <div class="color-picker-grid" id="colorPickerGrid"></div>
                </div>
                <div class="form-group">
                    <label class="form-label">Table Name</label>
                    <input type="text" class="form-input" id="tableNameInput" placeholder="table_name">
                </div>
                <div class="form-group">
                    <label class="form-label">Columns</label>
                    <div class="columns-container" id="columnsContainer"></div>
                    <button class="add-column-btn" id="addColumnBtn"><i class="fas fa-plus"></i> Add Column</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelTableBtn">Cancel</button>
                <button class="btn btn-primary" id="saveTableBtn">Save</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay hidden" id="pngModal">
        <div class="modal png-export-modal">
            <h2 class="modal-title"><i class="fas fa-image"></i> Export PNG</h2>
            <div class="modal-body">
                <div class="png-preview-container" id="pngPreviewContainer"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="pngCancelBtn">Cancel</button>
                <button class="btn btn-secondary" id="pngClipboardBtn"><i class="fas fa-clipboard"></i> Copy to Clipboard</button>
                <button class="btn btn-primary" id="pngDownloadBtn"><i class="fas fa-download"></i> Download</button>
            </div>
        </div>
    </div>

    <div class="toast-container" id="toastContainer"></div>

    <!-- JS Modules (order matters: dependencies first) -->
    <script src="js/parser.js"></script>
    <script src="js/state.js"></script>
    <script src="js/geometry.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/render-relationships.js"></script>
    <script src="js/relationships.js"></script>
    <script src="js/tables.js"></script>
    <script src="js/viewport.js"></script>
    <script src="js/dragdrop.js"></script>
    <script src="js/modals.js"></script>
    <script src="js/export.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
